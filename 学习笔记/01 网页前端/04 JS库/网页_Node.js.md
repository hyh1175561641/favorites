



# 简介

简单的说 Node.js 就是运行在服务端的 JavaScript。

Node.js 是一个基于Chrome JavaScript 运行时建立的一个平台。

Node.js是一个事件驱动I/O服务端JavaScript环境，基于Google的V8引擎，V8引擎执行Javascript的速度非常快，性能非常好。

## mac安装与配置

```bash
安装位置
/usr/local/bin/node
/usr/local/bin/npm

确保/usr/local/bin is in your $PATH


```



## 命令行

```bash
$ node -h
Usage: node [options] [ script.js ] [arguments]
       node inspect [options] [ script.js | host:port ] [arguments]

Options:
  -                           script read from stdin (default if no
                              file name is provided, interactive mode
                              if a tty)
  --                          indicate the end of node options
  --abort-on-uncaught-exception
                              aborting instead of exiting causes a
                              core file to be generated for analysis
  -c, --check                 syntax check script without executing
  --completion-bash           print source-able bash completion
                              script
  --cpu-prof                  Start the V8 CPU profiler on start up,
                              and write the CPU profile to disk
                              before exit. If --cpu-prof-dir is not
                              specified, write the profile to the
                              current working directory.
  --cpu-prof-dir=...          Directory where the V8 profiles
                              generated by --cpu-prof will be placed.
                              Does not affect --prof.
  --cpu-prof-interval=...     specified sampling interval in
                              microseconds for the V8 CPU profile
                              generated with --cpu-prof. (default:
                              1000)
  --cpu-prof-name=...         specified file name of the V8 CPU
                              profile generated with --cpu-prof
  --disallow-code-generation-from-strings
                              disallow eval and friends
  --enable-source-maps        experimental Source Map V3 support
  -e, --eval=...              evaluate script
  --experimental-json-modules experimental JSON interop support for
                              the ES Module loader
  --loader, --experimental-loader=...
                              (with --experimental-modules) use the
                              specified file as a custom loader
  --experimental-modules      experimental ES Module support and
                              caching modules
  --experimental-policy=...   use the specified file as a security
                              policy
  --experimental-repl-await   experimental await keyword support in
                              REPL
  --experimental-report       enable report generation
  --experimental-specifier-resolution=...
                              Select extension resolution algorithm
                              for es modules; either 'explicit'
                              (default) or 'node'
  --experimental-vm-modules   experimental ES Module support in vm
                              module
  --experimental-wasi-unstable-preview1
                              experimental WASI support
  --experimental-wasm-modules experimental ES Module support for
                              webassembly modules
  --force-context-aware       disable loading non-context-aware
                              addons
  --frozen-intrinsics         experimental frozen intrinsics support
  --heap-prof                 Start the V8 heap profiler on start up,
                              and write the heap profile to disk
                              before exit. If --heap-prof-dir is not
                              specified, write the profile to the
                              current working directory.
  --heap-prof-dir=...         Directory where the V8 heap profiles
                              generated by --heap-prof will be
                              placed.
  --heap-prof-interval=...    specified sampling interval in bytes
                              for the V8 heap profile generated with
                              --heap-prof. (default: 512 * 1024)
  --heap-prof-name=...        specified file name of the V8 CPU
                              profile generated with --heap-prof
  --heapsnapshot-signal=...   Generate heap snapshot on specified
                              signal
  -h, --help                  print node command line options
                              (currently set)
  --http-parser=...           Select which HTTP parser to use; either
                              'legacy' or 'llhttp' (default: llhttp).
  --http-server-default-timeout=...
                              Default http server socket timeout in
                              ms (default: 120000)
  --icu-data-dir=...          set ICU data load path to dir
                              (overrides NODE_ICU_DATA)
  --input-type=...            set module type for string input
  --insecure-http-parser      Use an insecure HTTP parser that
                              accepts invalid HTTP headers
  --inspect[=[host:]port]     activate inspector on host:port
                              (default: 127.0.0.1:9229)
  --inspect-brk[=[host:]port] activate inspector on host:port and
                              break at start of user script
  --debug-port, --inspect-port=[host:]port
                              set host:port for inspector
  --inspect-publish-uid=...   comma separated list of destinations
                              for inspector uid(default: stderr,http)
  -i, --interactive           always enter the REPL even if stdin
                              does not appear to be a terminal
  --interpreted-frames-native-stack
                              help system profilers to translate
                              JavaScript interpreted frames
  --max-http-header-size=...  set the maximum size of HTTP headers
                              (default: 8KB)
  --no-deprecation            silence deprecation warnings
  --no-force-async-hooks-checks
                              disable checks for async_hooks
  --no-warnings               silence all process warnings
  --openssl-config=...        load OpenSSL configuration from the
                              specified file (overrides OPENSSL_CONF)
  --pending-deprecation       emit pending deprecation warnings
  --policy-integrity=...      ensure the security policy contents
                              match the specified integrity
  --preserve-symlinks         preserve symbolic links when resolving
  --preserve-symlinks-main    preserve symbolic links when resolving
                              the main module
  -p, --print [...]           evaluate script and print result
  --prof-process              process V8 profiler output generated
                              using --prof
  --redirect-warnings=...     write warnings to file instead of
                              stderr
  --report-directory=...      define custom report pathname.
                              (default: current working directory of
                              Node.js process)
  --report-filename=...       define custom report file name.
                              (default:
                              YYYYMMDD.HHMMSS.PID.SEQUENCE#.txt)
  --report-on-fatalerror      generate diagnostic report on fatal
                              (internal) errors
  --report-on-signal          generate diagnostic report upon
                              receiving signals
  --report-signal=...         causes diagnostic report to be produced
                              on provided signal, unsupported in
                              Windows. (default: SIGUSR2)
  --report-uncaught-exception generate diagnostic report on uncaught
                              exceptions
  -r, --require=...           module to preload (option can be
                              repeated)
  --throw-deprecation         throw an exception on deprecations
  --title=...                 the process title to use on startup
  --tls-cipher-list=...       use an alternative default TLS cipher
                              list
  --tls-keylog=...            log TLS decryption keys to named file
                              for traffic analysis
  --tls-max-v1.2              set default TLS maximum to TLSv1.2
                              (default: TLSv1.3)
  --tls-max-v1.3              set default TLS maximum to TLSv1.3
                              (default: TLSv1.3)
  --tls-min-v1.0              set default TLS minimum to TLSv1.0
                              (default: TLSv1.2)
  --tls-min-v1.1              set default TLS minimum to TLSv1.1
                              (default: TLSv1.2)
  --tls-min-v1.2              set default TLS minimum to TLSv1.2
                              (default: TLSv1.2)
  --tls-min-v1.3              set default TLS minimum to TLSv1.3
                              (default: TLSv1.2)
  --trace-deprecation         show stack traces on deprecations
  --trace-event-categories=...
                              comma separated list of trace event
                              categories to record
  --trace-event-file-pattern=...
                              Template string specifying the filepath
                              for the trace-events data, it supports
                              ${rotation} and ${pid}.
  --trace-exit                show stack trace when an environment
                              exits
  --trace-sync-io             show stack trace when use of sync IO is
                              detected after the first tick
  --trace-tls                 prints TLS packet trace information to
                              stderr
  --trace-uncaught            show stack traces for the `throw`
                              behind uncaught exceptions
  --trace-warnings            show stack traces on process warnings
  --track-heap-objects        track heap object allocations for heap
                              snapshots
  --unhandled-rejections=...  define unhandled rejections behavior.
                              Options are 'strict' (raise an error),
                              'warn' (enforce warnings) or 'none'
                              (silence warnings)
  --use-bundled-ca            use bundled CA store (default)
  --use-openssl-ca            use OpenSSL's default CA store
  --v8-options                print V8 command line options
  --v8-pool-size=...          set V8's thread pool size
  -v, --version               print Node.js version # 打印node.js的版本
  --zero-fill-buffers         automatically zero-fill all newly
                              allocated Buffer and SlowBuffer
                              instances
  
Environment variables:
NODE_DEBUG                  ','-separated list of core modules that
                            should print debug information
NODE_DEBUG_NATIVE           ','-separated list of C++ core debug
                            categories that should print debug
                            output
NODE_DISABLE_COLORS         set to 1 to disable colors in the REPL
NODE_EXTRA_CA_CERTS         path to additional CA certificates file
NODE_NO_WARNINGS            set to 1 to silence process warnings
NODE_OPTIONS                set CLI options in the environment via
                            a space-separated list
NODE_PATH                   ':'-separated list of directories
                            prefixed to the module search path
NODE_PENDING_DEPRECATION    set to 1 to emit pending deprecation
                            warnings
NODE_PENDING_PIPE_INSTANCES set the number of pending pipe instance
                            handles on Windows
NODE_PRESERVE_SYMLINKS      set to 1 to preserve symbolic links
                            when resolving and caching modules
NODE_REDIRECT_WARNINGS      write warnings to path instead of
                            stderr
NODE_REPL_HISTORY           path to the persistent REPL history
                            file
NODE_TLS_REJECT_UNAUTHORIZED
                            set to 0 to disable TLS certificate
                            validation
NODE_V8_COVERAGE            directory to output v8 coverage JSON to
OPENSSL_CONF                load OpenSSL configuration from file
SSL_CERT_DIR                sets OpenSSL's directory of trusted
                            certificates when used in conjunction
                            with --use-openssl-ca
SSL_CERT_FILE               sets OpenSSL's trusted certificate file
                            when used in conjunction with
                            --use-openssl-ca
UV_THREADPOOL_SIZE          sets the number of threads used in
                            libuv's threadpool

Documentation can be found at https://nodejs.org/
```





## 交互模式和脚本模式

```
$ node node.js
$ node
> console.log('Hello');
Hello
```



# NPM包管理工具

命令行

```
$ npm

Usage: npm <command>

where <command> is one of:
    access, adduser, audit, bin, bugs, c, cache, ci, cit,
    clean-install, clean-install-test, completion, config,
    create, ddp, dedupe, deprecate, dist-tag, docs, doctor,
    edit, explore, fund, get, help, help-search, hook, i, init,
    install, install-ci-test, install-test, it, link, list, ln,
    login, logout, ls, org, outdated, owner, pack, ping, prefix,
    profile, prune, publish, rb, rebuild, repo, restart, root,
    run, run-script, s, se, search, set, shrinkwrap, star,
    stars, start, stop, t, team, test, token, tst, un,
    uninstall, unpublish, unstar, up, update, v, version, view,
    whoami

npm <command> -h  quick help on <command>
npm -l            display full usage info
npm help <term>   search for help on <term>
npm help npm      involved overview

Specify configs in the ini-formatted file:
    /Users/hyh/.npmrc
or on the command line via: npm <command> --key value
Config info can be viewed via: npm help config

npm@6.13.4 /usr/local/lib/node_modules/npm
```





```bash
$ npm -v # 查看版本
$ sudo npm install npm -g # 升级旧版npm
npm install npm -g # window系统升级npm
```

使用淘宝镜像的命令：

```
npm install -g cnpm --registry=https://registry.npm.taobao.org
```

## 安装模块

```bash
$ npm install <Module Name>
# js代码使用require引入模块
var express = require('express');
```

```bash
npm uninstall express # 卸载模块
npm ls # 查看包是否存在
npm update express # 更新模块
npm search express # 搜索模块

$ npm list -g # 查看已安装的模块
$ npm list grunt # 查看某个模块的版本号
```

**全局和本地**

全局安装是在node库中 (/usr/local/lib/node_modules/npm/docs)安装，全局安装加参数 -g

本地安装是在命令行的当前目录~下安装

## Package.json

```
package.json 位于模块的目录下，用于定义包的属性。接下来让我们来看下 express 包的 package.json 文件，位于 node_modules/express/package.json

name - 包名。
version - 包的版本号。
description - 包的描述。
homepage - 包的官网 url 。
author - 包的作者姓名。
contributors - 包的其他贡献者姓名。
dependencies - 依赖包列表。如果依赖包没有安装，npm 会自动将依赖包安装在 node_module 目录下。
repository - 包代码存放的地方的类型，可以是 git 或 svn，git 可在 Github 上。
main - main 字段指定了程序的主入口文件，require('moduleName') 就会加载这个文件。这个字段的默认值是模块根目录下面的 index.js。
keywords - 关键字
```





# 模块系统

# 模块





## HTTP

node不需要使用Apache或者NGINX来充当服务器，nodejs自带服务器模块，分为下面三步

1 引入required模块

2 创建服务器

3 接收请求与响应请求

```js
//使用require指令来载入http模块
var http = require('http');

http.createServer(function (request, response) {

    // 发送 HTTP 头部 
    // HTTP 状态值: 200 : OK
    // 内容类型: text/plain
    response.writeHead(200, {'Content-Type': 'text/plain'});

    // 发送响应数据 "Hello World"
    response.end('Hello World\n');
}).listen(8888);

// 终端打印如下信息
console.log('Server running at http://127.0.0.1:8888/');
```

```bash
$ node server.js # 启动服务
```

















# 链接

[node官网](https://nodejs.org/en/)

[node中文网](http://nodejs.cn)

[node runoob](https://www.runoob.com/nodejs/nodejs-tutorial.html)